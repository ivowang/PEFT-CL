2025-11-24 07:43:26,193 [trainer.py] => config: exps/cpt_c100.json
2025-11-24 07:43:26,195 [trainer.py] => prefix: reproduce
2025-11-24 07:43:26,195 [trainer.py] => dataset: cifar224
2025-11-24 07:43:26,195 [trainer.py] => memory_size: 0
2025-11-24 07:43:26,195 [trainer.py] => memory_per_class: 0
2025-11-24 07:43:26,195 [trainer.py] => fixed_memory: False
2025-11-24 07:43:26,195 [trainer.py] => shuffle: True
2025-11-24 07:43:26,195 [trainer.py] => init_cls: 10
2025-11-24 07:43:26,195 [trainer.py] => increment: 10
2025-11-24 07:43:26,195 [trainer.py] => model_name: cpt
2025-11-24 07:43:26,195 [trainer.py] => backbone_type: vit_base_patch16_224
2025-11-24 07:43:26,195 [trainer.py] => get_original_backbone: True
2025-11-24 07:43:26,195 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-24 07:43:26,195 [trainer.py] => seed: 0
2025-11-24 07:43:26,195 [trainer.py] => tuned_epoch: 10
2025-11-24 07:43:26,195 [trainer.py] => init_lr: 0.001
2025-11-24 07:43:26,195 [trainer.py] => cpt_first_lr: 0.001
2025-11-24 07:43:26,195 [trainer.py] => cpt_first_epochs: 20
2025-11-24 07:43:26,195 [trainer.py] => cpt_meta_lr: 0.001
2025-11-24 07:43:26,195 [trainer.py] => cpt_meta_epochs: 10
2025-11-24 07:43:26,195 [trainer.py] => batch_size: 16
2025-11-24 07:43:26,195 [trainer.py] => weight_decay: 0.0
2025-11-24 07:43:26,195 [trainer.py] => min_lr: 1e-05
2025-11-24 07:43:26,196 [trainer.py] => optimizer: adam
2025-11-24 07:43:26,196 [trainer.py] => scheduler: constant
2025-11-24 07:43:26,196 [trainer.py] => reinit_optimizer: True
2025-11-24 07:43:26,196 [trainer.py] => global_pool: token
2025-11-24 07:43:26,196 [trainer.py] => head_type: prompt
2025-11-24 07:43:26,196 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2025-11-24 07:43:26,196 [trainer.py] => pretrained: True
2025-11-24 07:43:26,196 [trainer.py] => drop: 0.0
2025-11-24 07:43:26,196 [trainer.py] => drop_path: 0.0
2025-11-24 07:43:26,196 [trainer.py] => prompt_pool: True
2025-11-24 07:43:26,196 [trainer.py] => size: 10
2025-11-24 07:43:26,196 [trainer.py] => length: 5
2025-11-24 07:43:26,196 [trainer.py] => top_k: 5
2025-11-24 07:43:26,196 [trainer.py] => initializer: uniform
2025-11-24 07:43:26,196 [trainer.py] => prompt_key: True
2025-11-24 07:43:26,196 [trainer.py] => prompt_key_init: uniform
2025-11-24 07:43:26,196 [trainer.py] => use_prompt_mask: False
2025-11-24 07:43:26,196 [trainer.py] => shared_prompt_pool: False
2025-11-24 07:43:26,196 [trainer.py] => shared_prompt_key: False
2025-11-24 07:43:26,196 [trainer.py] => batchwise_prompt: True
2025-11-24 07:43:26,196 [trainer.py] => embedding_key: cls
2025-11-24 07:43:26,196 [trainer.py] => predefined_key: 
2025-11-24 07:43:26,196 [trainer.py] => pull_constraint: True
2025-11-24 07:43:26,196 [trainer.py] => pull_constraint_coeff: 0.1
2025-11-24 07:43:26,196 [trainer.py] => mask_old_classes: False
2025-11-24 07:43:28,145 [data_manager.py] => [26, 86, 2, 55, 75, 93, 16, 73, 54, 95, 53, 92, 78, 13, 7, 30, 22, 24, 33, 8, 43, 62, 3, 71, 45, 48, 6, 99, 82, 76, 60, 80, 90, 68, 51, 27, 18, 56, 63, 74, 1, 61, 42, 41, 4, 15, 17, 40, 38, 5, 91, 59, 0, 34, 28, 50, 11, 35, 23, 52, 10, 31, 66, 57, 79, 85, 32, 84, 14, 89, 19, 29, 49, 97, 98, 69, 20, 94, 72, 77, 25, 37, 81, 46, 39, 65, 58, 12, 88, 70, 87, 36, 21, 83, 9, 96, 67, 64, 47, 44]
2025-11-24 07:43:30,128 [_builder.py] => Loading pretrained weights from url (https://storage.googleapis.com/vit_models/augreg/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz)
2025-11-24 07:43:30,146 [vit_cpt.py] => Pretrained npz load failed for vit_base_patch16_224_cpt (Expected hasRecord("version") to be true, but got false.  (Could this error message be improved?  If so, please report an enhancement request to PyTorch.)); retrying without pretrained weights.
2025-11-24 07:43:32,266 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-24 07:43:32,903 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-24 07:43:33,299 [_builder.py] => Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-11-24 07:43:33,318 [cpt.py] => 85,948,516 model total parameters.
2025-11-24 07:43:33,319 [cpt.py] => 130,660 model training parameters.
2025-11-24 07:43:33,319 [cpt.py] => prompt.first_prompt: 3840
2025-11-24 07:43:33,319 [cpt.py] => prompt.prompt: 38400
2025-11-24 07:43:33,319 [cpt.py] => prompt.meta_prompt: 3840
2025-11-24 07:43:33,319 [cpt.py] => prompt.prompt_key: 7680
2025-11-24 07:43:33,320 [cpt.py] => head.weight: 76800
2025-11-24 07:43:33,320 [cpt.py] => head.bias: 100
2025-11-24 07:43:33,321 [trainer.py] => All params: 171824072
2025-11-24 07:43:33,322 [trainer.py] => Trainable params: 130660
2025-11-24 07:43:33,322 [cpt.py] => Learning on 0-10
2025-11-24 07:43:34,355 [cpt.py] => Training first_prompt for task 0
2025-11-24 08:00:00,641 [cpt.py] => Task 0, Epoch 20/20 => Loss 1.826, Train_accy 33.64, Test_accy 37.00
2025-11-24 08:00:07,253 [trainer.py] => No NME accuracy.
2025-11-24 08:00:07,254 [trainer.py] => CNN: {'total': np.float64(37.0), '00-09': np.float64(37.0), 'old': 0, 'new': np.float64(37.0)}
2025-11-24 08:00:07,254 [trainer.py] => CNN top1 curve: [np.float64(37.0)]
2025-11-24 08:00:07,254 [trainer.py] => CNN top5 curve: [np.float64(85.6)]

2025-11-24 08:00:07,255 [trainer.py] => Average Accuracy (CNN): 37.0 

2025-11-24 08:00:07,256 [trainer.py] => All params: 171824072
2025-11-24 08:00:07,257 [trainer.py] => Trainable params: 130660
2025-11-24 08:00:07,257 [cpt.py] => Learning on 10-20
2025-11-24 08:00:07,329 [cpt.py] => Training prompt for task 1
