2025-11-23 14:59:01,684 [trainer.py] => config: exps/coda_prompt.json
2025-11-23 14:59:01,685 [trainer.py] => prefix:  
2025-11-23 14:59:01,685 [trainer.py] => dataset: cifar224
2025-11-23 14:59:01,685 [trainer.py] => memory_size: 0
2025-11-23 14:59:01,685 [trainer.py] => memory_per_class: 0
2025-11-23 14:59:01,685 [trainer.py] => fixed_memory: False
2025-11-23 14:59:01,685 [trainer.py] => shuffle: False
2025-11-23 14:59:01,685 [trainer.py] => init_cls: 10
2025-11-23 14:59:01,686 [trainer.py] => increment: 10
2025-11-23 14:59:01,686 [trainer.py] => model_name: coda_prompt
2025-11-23 14:59:01,686 [trainer.py] => backbone_type: vit_base_patch16_224_coda_prompt
2025-11-23 14:59:01,686 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-23 14:59:01,686 [trainer.py] => seed: 0
2025-11-23 14:59:01,686 [trainer.py] => tuned_epoch: 20
2025-11-23 14:59:01,686 [trainer.py] => init_lr: 0.001
2025-11-23 14:59:01,686 [trainer.py] => batch_size: 128
2025-11-23 14:59:01,686 [trainer.py] => weight_decay: 0
2025-11-23 14:59:01,686 [trainer.py] => min_lr: 1e-05
2025-11-23 14:59:01,686 [trainer.py] => optimizer: adam
2025-11-23 14:59:01,686 [trainer.py] => scheduler: cosine
2025-11-23 14:59:01,686 [trainer.py] => reinit_optimizer: True
2025-11-23 14:59:01,686 [trainer.py] => pretrained: True
2025-11-23 14:59:01,687 [trainer.py] => drop: 0.0
2025-11-23 14:59:01,687 [trainer.py] => drop_path: 0.0
2025-11-23 14:59:01,687 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2025-11-23 14:59:03,603 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-11-23 14:59:05,597 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-23 14:59:05,910 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-23 14:59:05,936 [_builder.py] => Unexpected keys (head.bias, head.weight) found while loading pretrained weights. This may be expected if model is being adapted.
2025-11-23 14:59:06,046 [coda_prompt.py] => 89,715,556 total parameters.
2025-11-23 14:59:06,047 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2025-11-23 14:59:06,047 [trainer.py] => All params: 89715556
2025-11-23 14:59:06,047 [trainer.py] => Trainable params: 89715556
2025-11-23 14:59:06,048 [coda_prompt.py] => Learning on 0-10
2025-11-23 15:17:38,899 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.134, Train_accy 95.73, Test_accy 99.20
2025-11-23 15:17:44,981 [trainer.py] => No NME accuracy.
2025-11-23 15:17:44,984 [trainer.py] => CNN: {'total': np.float64(99.2), '00-09': np.float64(99.2), 'old': 0, 'new': np.float64(99.2)}
2025-11-23 15:17:44,984 [trainer.py] => CNN top1 curve: [np.float64(99.2)]
2025-11-23 15:17:44,984 [trainer.py] => CNN top5 curve: [np.float64(100.0)]

2025-11-23 15:17:44,985 [trainer.py] => Average Accuracy (CNN): 99.2 

2025-11-23 15:17:44,986 [trainer.py] => All params: 89715556
2025-11-23 15:17:44,987 [trainer.py] => Trainable params: 89715556
2025-11-23 15:17:45,775 [coda_prompt.py] => Learning on 10-20
2025-11-23 15:37:19,041 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.163, Train_accy 94.75, Test_accy 96.30
2025-11-23 15:37:30,486 [trainer.py] => No NME accuracy.
2025-11-23 15:37:30,490 [trainer.py] => CNN: {'total': np.float64(96.3), '00-09': np.float64(97.2), '10-19': np.float64(95.4), 'old': np.float64(97.2), 'new': np.float64(95.4)}
2025-11-23 15:37:30,490 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3)]
2025-11-23 15:37:30,490 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85)]

2025-11-23 15:37:30,491 [trainer.py] => Average Accuracy (CNN): 97.75 

2025-11-23 15:37:30,492 [trainer.py] => All params: 89715556
2025-11-23 15:37:30,492 [trainer.py] => Trainable params: 89715556
2025-11-23 15:37:31,296 [coda_prompt.py] => Learning on 20-30
2025-11-23 15:56:57,078 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.149, Train_accy 95.21, Test_accy 94.63
2025-11-23 15:57:14,238 [trainer.py] => No NME accuracy.
2025-11-23 15:57:14,239 [trainer.py] => CNN: {'total': np.float64(94.63), '00-09': np.float64(95.4), '10-19': np.float64(94.0), '20-29': np.float64(94.5), 'old': np.float64(94.7), 'new': np.float64(94.5)}
2025-11-23 15:57:14,239 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3), np.float64(94.63)]
2025-11-23 15:57:14,239 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85), np.float64(99.7)]

2025-11-23 15:57:14,239 [trainer.py] => Average Accuracy (CNN): 96.71 

2025-11-23 15:57:14,239 [trainer.py] => All params: 89715556
2025-11-23 15:57:14,240 [trainer.py] => Trainable params: 89715556
2025-11-23 15:57:15,610 [coda_prompt.py] => Learning on 30-40
2025-11-23 16:17:24,737 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.137, Train_accy 95.63, Test_accy 92.82
2025-11-23 16:17:47,245 [trainer.py] => No NME accuracy.
2025-11-23 16:17:47,249 [trainer.py] => CNN: {'total': np.float64(92.82), '00-09': np.float64(95.3), '10-19': np.float64(92.0), '20-29': np.float64(94.1), '30-39': np.float64(89.9), 'old': np.float64(93.8), 'new': np.float64(89.9)}
2025-11-23 16:17:47,249 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3), np.float64(94.63), np.float64(92.82)]
2025-11-23 16:17:47,249 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85), np.float64(99.7), np.float64(99.55)]

2025-11-23 16:17:47,251 [trainer.py] => Average Accuracy (CNN): 95.7375 

2025-11-23 16:17:47,251 [trainer.py] => All params: 89715556
2025-11-23 16:17:47,252 [trainer.py] => Trainable params: 89715556
2025-11-23 16:17:48,733 [coda_prompt.py] => Learning on 40-50
2025-11-23 16:39:03,748 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.122, Train_accy 95.81, Test_accy 91.66
2025-11-23 16:39:31,595 [trainer.py] => No NME accuracy.
2025-11-23 16:39:31,601 [trainer.py] => CNN: {'total': np.float64(91.66), '00-09': np.float64(93.9), '10-19': np.float64(89.2), '20-29': np.float64(92.4), '30-39': np.float64(88.3), '40-49': np.float64(94.5), 'old': np.float64(90.95), 'new': np.float64(94.5)}
2025-11-23 16:39:31,601 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3), np.float64(94.63), np.float64(92.82), np.float64(91.66)]
2025-11-23 16:39:31,601 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85), np.float64(99.7), np.float64(99.55), np.float64(99.44)]

2025-11-23 16:39:31,602 [trainer.py] => Average Accuracy (CNN): 94.922 

2025-11-23 16:39:31,603 [trainer.py] => All params: 89715556
2025-11-23 16:39:31,603 [trainer.py] => Trainable params: 89715556
2025-11-23 16:39:33,195 [coda_prompt.py] => Learning on 50-60
2025-11-23 17:00:08,980 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.152, Train_accy 94.41, Test_accy 88.97
2025-11-23 17:00:42,227 [trainer.py] => No NME accuracy.
2025-11-23 17:00:42,228 [trainer.py] => CNN: {'total': np.float64(88.97), '00-09': np.float64(93.7), '10-19': np.float64(88.1), '20-29': np.float64(91.4), '30-39': np.float64(87.5), '40-49': np.float64(94.5), '50-59': np.float64(78.6), 'old': np.float64(91.04), 'new': np.float64(78.6)}
2025-11-23 17:00:42,228 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3), np.float64(94.63), np.float64(92.82), np.float64(91.66), np.float64(88.97)]
2025-11-23 17:00:42,228 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85), np.float64(99.7), np.float64(99.55), np.float64(99.44), np.float64(99.33)]

2025-11-23 17:00:42,231 [trainer.py] => Average Accuracy (CNN): 93.93 

2025-11-23 17:00:42,232 [trainer.py] => All params: 89715556
2025-11-23 17:00:42,232 [trainer.py] => Trainable params: 89715556
2025-11-23 17:00:44,186 [coda_prompt.py] => Learning on 60-70
2025-11-23 17:21:19,227 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.146, Train_accy 95.05, Test_accy 87.63
2025-11-23 17:21:57,787 [trainer.py] => No NME accuracy.
2025-11-23 17:21:57,787 [trainer.py] => CNN: {'total': np.float64(87.63), '00-09': np.float64(93.0), '10-19': np.float64(86.4), '20-29': np.float64(90.6), '30-39': np.float64(87.0), '40-49': np.float64(94.6), '50-59': np.float64(75.8), '60-69': np.float64(86.0), 'old': np.float64(87.9), 'new': np.float64(86.0)}
2025-11-23 17:21:57,788 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3), np.float64(94.63), np.float64(92.82), np.float64(91.66), np.float64(88.97), np.float64(87.63)]
2025-11-23 17:21:57,788 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85), np.float64(99.7), np.float64(99.55), np.float64(99.44), np.float64(99.33), np.float64(99.07)]

2025-11-23 17:21:57,793 [trainer.py] => Average Accuracy (CNN): 93.03 

2025-11-23 17:21:57,795 [trainer.py] => All params: 89715556
2025-11-23 17:21:57,795 [trainer.py] => Trainable params: 89715556
2025-11-23 17:22:00,101 [coda_prompt.py] => Learning on 70-80
2025-11-23 17:43:09,336 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.137, Train_accy 95.39, Test_accy 86.89
2025-11-23 17:43:53,159 [trainer.py] => No NME accuracy.
2025-11-23 17:43:53,161 [trainer.py] => CNN: {'total': np.float64(86.89), '00-09': np.float64(92.8), '10-19': np.float64(86.1), '20-29': np.float64(89.0), '30-39': np.float64(86.6), '40-49': np.float64(94.7), '50-59': np.float64(75.7), '60-69': np.float64(84.0), '70-79': np.float64(86.2), 'old': np.float64(86.99), 'new': np.float64(86.2)}
2025-11-23 17:43:53,161 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3), np.float64(94.63), np.float64(92.82), np.float64(91.66), np.float64(88.97), np.float64(87.63), np.float64(86.89)]
2025-11-23 17:43:53,161 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85), np.float64(99.7), np.float64(99.55), np.float64(99.44), np.float64(99.33), np.float64(99.07), np.float64(98.69)]

2025-11-23 17:43:53,162 [trainer.py] => Average Accuracy (CNN): 92.2625 

2025-11-23 17:43:53,163 [trainer.py] => All params: 89715556
2025-11-23 17:43:53,163 [trainer.py] => Trainable params: 89715556
2025-11-23 17:43:56,107 [coda_prompt.py] => Learning on 80-90
2025-11-23 18:05:27,419 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.115, Train_accy 96.27, Test_accy 87.26
2025-11-23 18:06:17,306 [trainer.py] => No NME accuracy.
2025-11-23 18:06:17,308 [trainer.py] => CNN: {'total': np.float64(87.26), '00-09': np.float64(93.1), '10-19': np.float64(85.4), '20-29': np.float64(89.2), '30-39': np.float64(86.3), '40-49': np.float64(94.3), '50-59': np.float64(76.0), '60-69': np.float64(82.1), '70-79': np.float64(85.2), '80-89': np.float64(93.7), 'old': np.float64(86.45), 'new': np.float64(93.7)}
2025-11-23 18:06:17,308 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3), np.float64(94.63), np.float64(92.82), np.float64(91.66), np.float64(88.97), np.float64(87.63), np.float64(86.89), np.float64(87.26)]
2025-11-23 18:06:17,308 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85), np.float64(99.7), np.float64(99.55), np.float64(99.44), np.float64(99.33), np.float64(99.07), np.float64(98.69), np.float64(98.49)]

2025-11-23 18:06:17,309 [trainer.py] => Average Accuracy (CNN): 91.70666666666666 

2025-11-23 18:06:17,309 [trainer.py] => All params: 89715556
2025-11-23 18:06:17,310 [trainer.py] => Trainable params: 89715556
2025-11-23 18:06:21,068 [coda_prompt.py] => Learning on 90-100
2025-11-23 18:28:04,471 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.089, Train_accy 97.22, Test_accy 86.51
2025-11-23 18:29:01,982 [trainer.py] => No NME accuracy.
2025-11-23 18:29:01,984 [trainer.py] => CNN: {'total': np.float64(86.51), '00-09': np.float64(93.1), '10-19': np.float64(84.7), '20-29': np.float64(88.3), '30-39': np.float64(84.3), '40-49': np.float64(92.8), '50-59': np.float64(75.0), '60-69': np.float64(82.1), '70-79': np.float64(84.2), '80-89': np.float64(92.6), '90-99': np.float64(88.0), 'old': np.float64(86.34), 'new': np.float64(88.0)}
2025-11-23 18:29:01,985 [trainer.py] => CNN top1 curve: [np.float64(99.2), np.float64(96.3), np.float64(94.63), np.float64(92.82), np.float64(91.66), np.float64(88.97), np.float64(87.63), np.float64(86.89), np.float64(87.26), np.float64(86.51)]
2025-11-23 18:29:01,985 [trainer.py] => CNN top5 curve: [np.float64(100.0), np.float64(99.85), np.float64(99.7), np.float64(99.55), np.float64(99.44), np.float64(99.33), np.float64(99.07), np.float64(98.69), np.float64(98.49), np.float64(98.45)]

2025-11-23 18:29:01,986 [trainer.py] => Average Accuracy (CNN): 91.187 

